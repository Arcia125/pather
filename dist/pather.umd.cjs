(function(n,o){typeof exports=="object"&&typeof module<"u"?o(exports):typeof define=="function"&&define.amd?define(["exports"],o):(n=typeof globalThis<"u"?globalThis:n||self,o(n.pather={}))})(this,function(n){"use strict";var x=Object.defineProperty;var y=(n,o,c)=>o in n?x(n,o,{enumerable:!0,configurable:!0,writable:!0,value:c}):n[o]=c;var r=(n,o,c)=>(y(n,typeof o!="symbol"?o+"":o,c),c);class o{constructor(t=null,i){r(this,"g",0);r(this,"h",0);r(this,"equals",t=>o.equals(this,t));this.parent=t,this.position=i}static equals(t,i){var s,e,a,d;return!t.position||!i.position?!1:((s=t.position)==null?void 0:s.x)===((e=i.position)==null?void 0:e.x)&&((a=t.position)==null?void 0:a.y)===((d=i.position)==null?void 0:d.y)}get f(){return this.g+this.h}get x(){return this.position.x}set x(t){this.position.x=t}get y(){return this.position.y}set y(t){this.position.y=t}}const c=h=>{const t=[];let i=h;for(;i.parent;)t.push(i),i=i.parent;return t},l=(h,t=!1)=>{const i=h.position.x,s=h.position.y;let e=[{x:0,y:-1},{x:0,y:1},{x:-1,y:0},{x:1,y:0}];return t&&(e=e.concat([{x:-1,y:-1},{x:1,y:-1},{x:-1,y:1},{x:1,y:1}])),e.map(a=>new o(h,{x:i+a.x,y:s+a.y}))},p={DEFAULT:(h,t)=>Math.abs(h.position.x-t.position.x)+Math.abs(h.position.y-t.position.y)},u={DEFAULT:(h,t)=>h.equals(t)},f=99999;class N{constructor(t){r(this,"possibleNodes");r(this,"checkedNodes");r(this,"start");r(this,"end");r(this,"iterations");r(this,"config");r(this,"initialState",()=>{const i=new o(null,this.config.startPos),s=new o(null,this.config.endPos),e=[],a=[];return e.push(this.start),{iterations:0,start:i,end:s,possibleNodes:e,checkedNodes:a}});r(this,"findPath",()=>{if(this.iterations!==0){const{start:t,end:i,iterations:s,possibleNodes:e,checkedNodes:a}=this.initialState();this.possibleNodes=e,this.checkedNodes=a,this.start=t,this.end=i,this.iterations=s}for(;this.possibleNodes.length;){if(this.iterations>=this.config.maxIterations)return;const t=this.checkNode();if(t!=null&&t.path)return t.path;this.iterations++}});r(this,"checkNode",()=>{this.possibleNodes.sort((s,e)=>e.f-s.f);const t=this.possibleNodes.pop();if(!t)return;if(this.checkedNodes.push(t),this.config.isDone(t,this.end))return{path:c(t).reverse()};const i=l(t,this.config.diagonal);for(let s of i)this.config.isOutOfBounds(s)||this.config.wouldCollide(s)||this.possibleNodes.filter(e=>e.equals(s)).length>0||this.checkedNodes.filter(e=>e.equals(s)).length>0||(s.g=t.g+1,s.h=this.config.heuristic(s,this.end),this.possibleNodes.push(s))});this.config={...t,heuristic:t.heuristic||p.DEFAULT,diagonal:t.diagonal||!1,maxIterations:t.maxIterations||f,isDone:t.isDone||u.DEFAULT};const{start:i,end:s,iterations:e,possibleNodes:a,checkedNodes:d}=this.initialState();this.possibleNodes=a,this.checkedNodes=d,this.start=i,this.end=s,this.iterations=e}}const g=(...h)=>new N(...h).findPath();n.PathNode=o,n.findPath=g,Object.defineProperty(n,Symbol.toStringTag,{value:"Module"})});
